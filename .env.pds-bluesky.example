# ============================================================================
# PDS Bluesky and Element/Matrix Integration Configuration
# ============================================================================

# ==== Federation Privacy & Encryption ====

# Enable federation privacy enforcement middleware
FEDERATION_PRIVACY_ENABLED=true

# AES-256-GCM encryption key for storing external API tokens
# Generate with: openssl rand -hex 32
FEDERATION_ENCRYPTION_KEY=your-64-char-hex-string-here

# ==== Bluesky PDS Configuration ====

# Bluesky PDS (Personal Data Server) endpoint
BLUESKY_PDS_URL=https://bsky.social

# AT Protocol XRPC API endpoint
BLUESKY_ATPROTO_URL=https://api.bsky.app/xrpc

# Optional: API key if required by PDS
BLUESKY_API_KEY=

# Bluesky user handle for webhook notifications (optional)
BLUESKY_WEBHOOK_HANDLE=

# ==== Element/Matrix Configuration (Phase 2) ====

# Element homeserver URL (Phase 2 implementation)
ELEMENT_HOMESERVER_URL=https://element.io

# Matrix API token/key (if required by homeserver)
ELEMENT_API_KEY=

# Element admin user ID for room management (optional)
ELEMENT_ADMIN_USER=

# ==== Cache Configuration ====

# TTL (in hours) for cached external posts (default: 24)
EXTERNAL_POST_CACHE_TTL_HOURS=24

# Redis connection for caching (optional, falls back to in-memory)
REDIS_URL=redis://localhost:6379/0

# ==== Audit & Logging ====

# Log level for federation operations
FEDERATION_LOG_LEVEL=info

# Enable verbose federation audit logging
FEDERATION_AUDIT_LOGGING=true

# Days to retain federated access logs (0 = infinite)
FEDERATED_ACCESS_LOG_RETENTION_DAYS=90

# Days to retain outbound block logs (0 = infinite, recommend infinite for security)
OUTBOUND_BLOCK_LOG_RETENTION_DAYS=0

# ==== Rate Limiting ====

# Max external API calls per user per hour
EXTERNAL_API_RATE_LIMIT_PER_USER=100

# Max external API calls globally per hour
EXTERNAL_API_RATE_LIMIT_GLOBAL=1000

# ==== Email Notifications (Phase 2) ====

# Notify admins of federation security events
FEDERATION_NOTIFY_ADMINS=true

# Admin email for federation notifications
FEDERATION_ADMIN_EMAIL=admin@pnptv.app

# ==== Webhook Configuration ====

# Bluesky webhook secret (for verifying inbound webhooks)
BLUESKY_WEBHOOK_SECRET=your-webhook-secret-here

# Element webhook secret (Phase 2)
ELEMENT_WEBHOOK_SECRET=your-webhook-secret-here

# ==== Feature Flags ====

# Enable Bluesky integration
FEATURE_BLUESKY_INTEGRATION=true

# Enable Element/Matrix integration (Phase 2)
FEATURE_ELEMENT_INTEGRATION=false

# Enable auto-sync of external profiles
FEATURE_AUTO_SYNC_PROFILES=false

# Enable external content in combined feed
FEATURE_COMBINED_FEED=true

# ==== Debug & Testing ====

# Enable debug mode (verbose logging, no encryption)
FEDERATION_DEBUG_MODE=false

# Allow test endpoints for federation testing
FEDERATION_TEST_ENDPOINTS_ENABLED=false

# Bluesky test mode (uses sandbox if available)
BLUESKY_TEST_MODE=false

# ==== Privacy & Data Handling ====

# Block all outbound federation (fail-safe mode)
FEDERATION_BLOCK_ALL_OUTBOUND=true

# Allow external user mentions in pnptv posts (Phase 2)
ALLOW_EXTERNAL_MENTIONS=false

# Allow embedding external content in pnptv posts
ALLOW_EXTERNAL_EMBEDS=false

# Encrypt all external profile metadata in database
ENCRYPT_EXTERNAL_METADATA=true

# Anonymize external user IDs in logs
ANONYMIZE_EXTERNAL_IDS_IN_LOGS=true
