# Fail2ban filter for PNPtv API abuse
# Detects excessive failed API requests

[Definition]

# Failed API requests (401, 403, 429 status codes)
failregex = ^<HOST> .* "(GET|POST|PUT|DELETE|PATCH) /api/.* HTTP.*" (401|403|429)

# Ignore successful requests
ignoreregex = ^<HOST> .* "(GET|POST|PUT|DELETE|PATCH) /api/.* HTTP.*" (200|201|204)
