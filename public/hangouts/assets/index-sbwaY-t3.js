const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CallRoom-BdlTWxPG.js","assets/vendor-BCuqLCnw.js"])))=>i.map(i=>d[i]);
import{r as ye,a as se,b as l,X as we,M as je,U as Ne,L as Pe,d as Ce,G as Re,e as Se,R as Ee}from"./vendor-BCuqLCnw.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var k={exports:{}},R={};var B;function Le(){if(B)return R;B=1;var e=ye(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(c,u,d){var f,p={},h=null,g=null;d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),u.ref!==void 0&&(g=u.ref);for(f in u)n.call(u,f)&&!o.hasOwnProperty(f)&&(p[f]=u[f]);if(c&&c.defaultProps)for(f in u=c.defaultProps,u)p[f]===void 0&&(p[f]=u[f]);return{$$typeof:t,type:c,key:h,ref:g,props:p,_owner:s.current}}return R.Fragment=r,R.jsx=i,R.jsxs=i,R}var q;function _e(){return q||(q=1,k.exports=Le()),k.exports}var a=_e(),T={},D;function Te(){if(D)return T;D=1;var e=se();return T.createRoot=e.createRoot,T.hydrateRoot=e.hydrateRoot,T}var Oe=Te();(function(){const t=window.Telegram?.WebApp,r=document.documentElement;if(t){const n=t.themeParams||{},s=(o,i)=>{i&&r.style.setProperty(o,i)};s("--tg-bg",n.bg_color),s("--tg-text",n.text_color),s("--tg-hint",n.hint_color),s("--tg-link",n.link_color),s("--tg-button",n.button_color),s("--tg-button-text",n.button_text_color),s("--tg-secondary-bg",n.secondary_bg_color),t.expand(),t.ready()}else r.style.setProperty("--tg-bg","#1c1c1e"),r.style.setProperty("--tg-text","#f5f5f7"),r.style.setProperty("--tg-hint","#8e8e93"),r.style.setProperty("--tg-link","#0a84ff"),r.style.setProperty("--tg-button","#0a84ff"),r.style.setProperty("--tg-button-text","#ffffff"),r.style.setProperty("--tg-secondary-bg","#2c2c2e")})();const Ue="modulepreload",ke=function(e){return"/hangouts/"+e},G={},Ae=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");s=u(r.map(d=>{if(d=ke(d),d in G)return;G[d]=!0;const f=d.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":Ue,f||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),f)return new Promise((g,y)=>{h.addEventListener("load",g),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};se();function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I.apply(this,arguments)}var V;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(V||(V={}));function v(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ie(e,t){{typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function K(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ae(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}var X;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(X||(X={}));function Me(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const $e=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fe=e=>$e.test(e);function ze(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?ae(e):e,o;if(r)if(Fe(r))o=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),Ie(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?o=H(r.substring(1),"/"):o=H(r,t)}else o=t;return{pathname:o,search:Je(n),hash:Be(s)}}function H(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function A(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function We(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function oe(e,t){let r=We(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ie(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=ae(e):(s=I({},e),v(!s.pathname||!s.pathname.includes("?"),A("?","pathname","search",s)),v(!s.pathname||!s.pathname.includes("#"),A("#","pathname","hash",s)),v(!s.search||!s.search.includes("#"),A("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,c;if(i==null)c=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),p-=1;s.pathname=h.join("/")}c=p>=0?t[p]:"/"}let u=ze(s,c),d=i&&i!=="/"&&i.endsWith("/"),f=(o||i===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const le=e=>e.join("/").replace(/\/\/+/g,"/"),Je=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Be=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,ce=["post","put","patch","delete"];new Set(ce);const qe=["get",...ce];new Set(qe);function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M.apply(this,arguments)}const ue=l.createContext(null),E=l.createContext(null),de=l.createContext(null),O=l.createContext({outlet:null,matches:[],isDataRoute:!1});function De(e,t){let{relative:r}=t===void 0?{}:t;F()||v(!1);let{basename:n,navigator:s}=l.useContext(E),{hash:o,pathname:i,search:c}=fe(e,{relative:r}),u=i;return n!=="/"&&(u=i==="/"?n:le([n,i])),s.createHref({pathname:u,search:c,hash:o})}function F(){return l.useContext(de)!=null}function z(){return F()||v(!1),l.useContext(de).location}function me(e){l.useContext(E).static||l.useLayoutEffect(e)}function Ge(){let{isDataRoute:e}=l.useContext(O);return e?Qe():Ve()}function Ve(){F()||v(!1);let e=l.useContext(ue),{basename:t,future:r,navigator:n}=l.useContext(E),{matches:s}=l.useContext(O),{pathname:o}=z(),i=JSON.stringify(oe(s,r.v7_relativeSplatPath)),c=l.useRef(!1);return me(()=>{c.current=!0}),l.useCallback(function(d,f){if(f===void 0&&(f={}),!c.current)return;if(typeof d=="number"){n.go(d);return}let p=ie(d,JSON.parse(i),o,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:le([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,i,o,e])}function fe(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=l.useContext(E),{matches:s}=l.useContext(O),{pathname:o}=z(),i=JSON.stringify(oe(s,n.v7_relativeSplatPath));return l.useMemo(()=>ie(e,JSON.parse(i),o,r==="path"),[e,i,o,r])}var he=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(he||{}),pe=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(pe||{});function Ke(e){let t=l.useContext(ue);return t||v(!1),t}function Xe(e){let t=l.useContext(O);return t||v(!1),t}function He(e){let t=Xe(),r=t.matches[t.matches.length-1];return r.route.id||v(!1),r.route.id}function Qe(){let{router:e}=Ke(he.UseNavigateStable),t=He(pe.UseNavigateStable),r=l.useRef(!1);return me(()=>{r.current=!0}),l.useCallback(function(s,o){o===void 0&&(o={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,M({fromRouteId:t},o)))},[e,t])}new Promise(()=>{});function $(){return $=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$.apply(this,arguments)}function Ye(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,o;for(o=0;o<n.length;o++)s=n[o],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Ze(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function et(e,t){return e.button===0&&(!t||t==="_self")&&!Ze(e)}const tt=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],rt="6";try{window.__reactRouterVersion=rt}catch{}const nt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",st=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Q=l.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:o,replace:i,state:c,target:u,to:d,preventScrollReset:f,viewTransition:p}=t,h=Ye(t,tt),{basename:g}=l.useContext(E),y,w=!1;if(typeof d=="string"&&st.test(d)&&(y=d,nt))try{let x=new URL(window.location.href),j=d.startsWith("//")?new URL(x.protocol+d):new URL(d),P=Me(j.pathname,g);j.origin===x.origin&&P!=null?d=P+j.search+j.hash:w=!0}catch{}let L=De(d,{relative:s}),_=at(d,{replace:i,state:c,target:u,preventScrollReset:f,relative:s,viewTransition:p});function N(x){n&&n(x),x.defaultPrevented||_(x)}return l.createElement("a",$({},h,{href:y||L,onClick:w||o?n:N,ref:r,target:u}))});var Y;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Y||(Y={}));var Z;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Z||(Z={}));function at(e,t){let{target:r,replace:n,state:s,preventScrollReset:o,relative:i,viewTransition:c}=t===void 0?{}:t,u=Ge(),d=z(),f=fe(e,{relative:i});return l.useCallback(p=>{if(et(p,r)){p.preventDefault();let h=n!==void 0?n:K(d)===K(f);u(e,{replace:h,state:s,preventScrollReset:o,relative:i,viewTransition:c})}},[d,u,f,n,s,r,e,o,i,c])}function ot(){const[e,t]=l.useState(!1),r=()=>{t(!e)};return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:r,className:"hamburger-menu-button",children:e?a.jsx(we,{size:24}):a.jsx(je,{size:24})}),a.jsx("div",{className:`off-canvas-menu-overlay ${e?"open":""}`,onClick:r}),a.jsxs("div",{className:`off-canvas-menu ${e?"open":""}`,children:[a.jsxs(Q,{to:"/app/profile",className:"menu-item",onClick:r,children:[a.jsx(Ne,{size:20})," My Profile"]}),a.jsxs("a",{href:"https://t.me/PNPLatinoTV_Bot",target:"_blank",rel:"noopener noreferrer",className:"menu-item",onClick:r,children:[a.jsx(Pe,{size:20})," Support"]}),a.jsxs(Q,{to:"/app/messages",className:"menu-item",onClick:r,children:[a.jsx(Ce,{size:20})," Direct Messages"]})]})]})}function ee({title:e,subtitle:t,telegramUser:r,onLogout:n}){return a.jsxs("header",{className:"header",children:[a.jsx("div",{className:"header-logo",style:{backgroundColor:"#120d14",padding:"5px"},children:a.jsx("img",{src:"/logo3.png",alt:"Logo",className:"h-8 w-auto"})}),a.jsx(ot,{})]})}const S=window.location.hostname==="localhost"?"http://localhost:3000/api":"/api",W=`${S}/hangouts`,te=()=>window.Telegram?.WebApp?.initData||"",U=(e="GET",t=null)=>{const r={"x-telegram-init-data":te()};return t&&(r["Content-Type"]="application/json"),{method:e,headers:r,body:t?JSON.stringify({...t,initData:te()}):void 0}},J=async(e,t)=>{const r=await e.json().catch(()=>null);if(!e.ok)throw new Error(r?.error||t);return r};async function re(){const e=await fetch(`${W}/public`,U());return(await J(e,"Failed to load rooms.")).rooms||[]}async function it(e){const t=await fetch(`${W}/create`,U("POST",e));return await J(t,"Failed to create room.")}async function lt(e){const t=await fetch(`${W}/join/${e}`,U("POST"));return await J(t,"Failed to join room.")}function ct(){const e=new URLSearchParams(window.location.search);return{token:e.get("token"),uid:e.get("uid"),room:e.get("room"),type:e.get("type"),callId:e.get("callId"),role:e.get("role")||""}}async function ut(){try{const e=await fetch(`${S}/telegram-auth/check`,U());return e.ok&&(await e.json()).user||null}catch(e){return console.error("Error fetching Telegram user:",e),null}}function dt(e){if(e.current){e.current.innerHTML="";const t=document.createElement("div");if(t.setAttribute("id","telegram-login-widget"),t.setAttribute("data-telegram-login","PNPtv_bot"),t.setAttribute("data-size","large"),t.setAttribute("data-auth-url",`${S}/webapp/auth/telegram`),t.setAttribute("data-request-access","write"),e.current.appendChild(t),!window.TelegramLoginWidget){const r=document.createElement("script");r.src="https://telegram.org/js/telegram-widget.js?22",r.async=!0,r.onload=()=>{window.Telegram?.Login?.embed&&window.Telegram.Login.embed("telegram-login-widget",{bot_id:"PNPtv_bot",size:"large",auth_url:`${S}/webapp/auth/telegram`,request_access:"write"})},document.head.appendChild(r)}}}async function mt(e,t,r,n){r(!0);try{const o=await(await fetch(`${S}/telegram-auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();o.success?t(o.user):n(o.message||"Telegram login failed.")}catch(s){console.error("Error during Telegram auth:",s),n("Network error during Telegram login.")}finally{r(!1)}}const ne=({baseUrl:e="/hangouts/",room:t,token:r,uid:n,username:s,type:o,appId:i,callId:c}={})=>{const u=new URL(e,window.location.origin);return t&&u.searchParams.set("room",t),r&&u.searchParams.set("token",r),n&&u.searchParams.set("uid",String(n)),s&&u.searchParams.set("username",s),o&&u.searchParams.set("type",o),i&&u.searchParams.set("appId",i),c&&u.searchParams.set("callId",c),u.pathname+(u.search||"")},wt=()=>{if(window.history?.replaceState){const e=`${window.location.origin}${window.location.pathname}`;window.history.replaceState({},document.title,e)}},ft=()=>{try{return window.Telegram?.WebApp||null}catch(e){return console.error("Telegram WebApp unavailable:",e),null}},ht=()=>!!ft(),pt=e=>{const t=Math.max(0,Math.floor(e/1e3));if(t<60)return`${t}s`;const r=Math.floor(t/60);return r<60?`${r}m`:`${Math.floor(r/60)}h`};function gt({telegramUser:e,role:t}){const[r,n]=l.useState([]),[s,o]=l.useState(!0),[i,c]=l.useState(""),[u,d]=l.useState(""),[f,p]=l.useState(10),[h,g]=l.useState(!0),[y,w]=l.useState(!1),[L,_]=l.useState(""),[N,x]=l.useState(""),j=ht()&&e?.initData,P=t?.toUpperCase()||"",ge=P==="PRIME"||P==="ADMIN";l.useEffect(()=>{let m=!0;return(async()=>{try{o(!0);const C=await re();m&&(n(C),c(""))}catch(C){m&&(n([]),c(C?.message||"Failed to load rooms."))}finally{m&&o(!1)}})(),()=>{m=!1}},[]),l.useEffect(()=>{if(!N)return;const m=setTimeout(()=>x(""),1800);return()=>clearTimeout(m)},[N]);const xe=async()=>{o(!0);try{const m=await re();n(m),c("")}catch(m){c(m?.message||"Failed to load rooms.")}finally{o(!1)}},be=async()=>{if(!ge){x("Only PRIME/ADMIN users can create rooms."),w(!1);return}if(h&&!j){x("Open from Telegram to create public rooms."),w(!1);return}try{w(!0);const m=await it({title:u,maxParticipants:f,isPublic:h,allowGuests:!0,enforceCamera:!1}),b=ne({room:m.room,token:m.token,uid:m.uid,username:e?.displayName||"Host",type:m.isPublic?"public":"private",appId:m.appId,callId:m.callId});window.location.href=b}catch(m){x(m?.message||"Failed to create room.")}finally{w(!1)}},ve=async m=>{if(!j){x("Open from Telegram to join rooms.");return}try{_(m);const b=await lt(m),C=ne({room:b.room,token:b.token,uid:b.uid,username:e?.displayName||"Guest",type:b.isPublic?"public":"private",appId:b.appId,callId:b.callId});window.location.href=C}catch(b){x(b?.message||"Failed to join room.")}finally{_("")}};return a.jsxs("main",{className:"max-w-4xl mx-auto px-4 py-8",children:[a.jsxs("section",{className:"bg-color-2 p-6 rounded-lg shadow-md mb-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"block text-sm font-medium text-muted-color mb-2",children:"Title"}),a.jsx("input",{className:"w-full px-4 py-2 bg-color border border-color rounded-md focus:outline-none focus:ring-2 focus:ring-primary-color",value:u,onChange:m=>d(m.target.value),placeholder:"e.g., Late-night vibez"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"block text-sm font-medium text-muted-color mb-2",children:"Visibility"}),a.jsxs("div",{className:"flex rounded-md bg-color border border-color p-1",children:[a.jsxs("button",{className:`w-1/2 py-2 text-sm rounded-md transition-colors ${h?"bg-primary-color text-white":"text-muted-color"}`,onClick:()=>g(!0),type:"button",children:[a.jsx(Re,{size:16,className:"inline-block mr-2"})," Public"]}),a.jsxs("button",{className:`w-1/2 py-2 text-sm rounded-md transition-colors ${h?"text-muted-color":"bg-primary-color text-white"}`,onClick:()=>g(!1),type:"button",children:[a.jsx(Se,{size:16,className:"inline-block mr-2"})," Private"]})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{className:"block text-sm font-medium text-muted-color mb-2",children:"Max participants"}),a.jsx("input",{className:"w-full px-4 py-2 bg-color border border-color rounded-md focus:outline-none focus:ring-2 focus:ring-primary-color",type:"number",min:2,max:50,value:f,onChange:m=>p(Number(m.target.value))})]})]}),a.jsx("p",{className:"text-sm text-muted-color mt-4",children:"Public rooms send a community notification with a join link. Private rooms stay invite-only."}),a.jsxs("div",{className:"flex gap-4 mt-6",children:[a.jsx("button",{className:"btn btn-primary",onClick:be,disabled:y,children:y?"Creating...":"Create room"}),a.jsx("button",{className:"btn btn-secondary",onClick:xe,disabled:s,children:"Refresh"})]})]}),a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Public rooms"}),i&&a.jsx("div",{className:"bg-destructive-color/20 text-destructive-color p-4 rounded-md mb-4",children:i}),s?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx("div",{className:"spinner-lg"}),a.jsx("p",{className:"text-muted-color mt-4",children:"Loading rooms..."})]}):r.length===0?a.jsxs("div",{className:"text-center p-8 bg-color-2 rounded-lg shadow-md",children:[a.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No public rooms right now"}),a.jsx("p",{className:"text-muted-color",children:"Create one and it will appear here."})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(m=>a.jsxs("div",{className:"bg-color-2 p-6 rounded-lg shadow-md",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsx("span",{className:"text-xs font-medium bg-secondary-color/20 text-secondary-color px-2 py-1 rounded-full",children:"Public"}),a.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>ve(m.id),disabled:L===m.id,children:L===m.id?"Joining...":"Join"})]}),a.jsx("h3",{className:"text-lg font-bold mb-2",children:m.title||"Untitled room"}),a.jsxs("p",{className:"text-sm text-muted-color mb-4",children:["Host: ",a.jsx("span",{className:"font-mono",children:m.creatorName||"Unknown"})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-color",children:[a.jsxs("span",{children:[m.currentParticipants||0,"/",m.maxParticipants||0," participants"]}),m.createdAt&&a.jsxs("span",{children:[pt(Date.now()-new Date(m.createdAt).getTime())," ago"]})]})]},m.id))}),N&&a.jsx("div",{className:"fixed bottom-8 right-8 bg-color-2 text-color px-6 py-3 rounded-lg shadow-lg animate-fade-in-out",children:N})]})}const xt=({onAuthSuccess:e,authLoading:t})=>{const r=l.useRef(null);return l.useEffect(()=>{t||dt(r)},[t]),a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-color",children:a.jsxs("div",{className:"w-full max-w-sm p-8 space-y-6 bg-color-2 rounded-lg shadow-md",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"PNPtv Hangouts"}),a.jsx("p",{className:"mt-2 text-muted-color",children:"Log in with Telegram to continue"})]}),t?a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"spinner-lg"})}):a.jsx("div",{ref:r,className:"mt-4"})]})})},bt=l.lazy(()=>Ae(()=>import("./CallRoom-BdlTWxPG.js"),__vite__mapDeps([0,1])));function vt(){const e=l.useMemo(()=>ct(),[]),t=(e.role||"").toUpperCase(),[r,n]=l.useState(null),[s,o]=l.useState(!0),[i,c]=l.useState(!1),[u,d]=l.useState(null);l.useRef(null),l.useEffect(()=>{(async()=>{o(!0);try{const g=await ut();g?(n(g),c(!0)):c(!1)}catch(g){d(g.message),c(!1)}finally{o(!1)}})(),window.onTelegramAuth=async g=>{await mt(g,n,o,d),c(!0)}},[]);const f=async()=>{try{await fetch("/api/logout",{method:"POST"}),n(null),c(!1)}catch(h){console.error("Logout failed:",h)}};return s?a.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-color",children:[a.jsx("div",{className:"spinner-lg"}),a.jsx("p",{className:"text-muted-color mt-4",children:"Loading authentication..."})]}):i?e.room&&e.token&&e.uid?a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"PNPtv Hangouts",telegramUser:r,onLogout:f}),a.jsx(l.Suspense,{fallback:a.jsxs("div",{className:"loading-state",children:[a.jsx("div",{className:"spinner-lg"}),a.jsx("div",{className:"text-muted-foreground mt-4",children:"Loading call..."})]}),children:a.jsx(bt,{params:e,telegramUser:r})})]}):a.jsxs(a.Fragment,{children:[a.jsx(ee,{title:"PNPtv Hangouts",subtitle:"Video Calls",telegramUser:r,onLogout:f}),a.jsx(gt,{telegramUser:r,role:t})]}):a.jsx(xt,{onAuthSuccess:()=>c(!0),authLoading:s})}Oe.createRoot(document.getElementById("root")).render(a.jsx(Ee.StrictMode,{children:a.jsx(vt,{})}));export{Ae as _,a as j,wt as s};
