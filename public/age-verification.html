<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Age Verification - PNPtv</title>
  <meta name="description" content="Age verification required to access PNPtv adult content platform.">
  <link rel="stylesheet" href="/unified-design.css">
  <style>
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
    }

    .verification-container {
      max-width: 500px;
      width: 100%;
      background: rgba(0, 0, 0, 0.85);
      border-radius: 24px;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .logo {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo h1 {
      font-size: 2.5rem;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
    }

    .logo .tagline {
      color: var(--text-muted);
      font-size: 14px;
    }

    .warning-box {
      background: rgba(255, 68, 68, 0.15);
      border: 1px solid rgba(255, 68, 68, 0.4);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 25px;
      text-align: center;
    }

    .warning-box .icon {
      font-size: 48px;
      margin-bottom: 10px;
    }

    .warning-box h2 {
      color: #ff6b6b;
      font-size: 1.3rem;
      margin-bottom: 10px;
    }

    .warning-box p {
      color: #ffaaaa;
      font-size: 14px;
      margin: 0;
      line-height: 1.6;
    }

    .age-question {
      text-align: center;
      margin-bottom: 30px;
    }

    .age-question h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    .age-question p {
      color: var(--text-muted);
      font-size: 14px;
    }

    .verification-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 25px;
    }

    .verify-btn {
      width: 100%;
      padding: 18px 24px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .verify-btn.primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.35);
    }

    .verify-btn.primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
    }

    .verify-btn.secondary {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .verify-btn.secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .verify-btn.exit {
      background: rgba(255, 68, 68, 0.2);
      color: #ff6b6b;
      border: 1px solid rgba(255, 68, 68, 0.3);
    }

    .verify-btn.exit:hover {
      background: rgba(255, 68, 68, 0.3);
    }

    .verify-btn .icon {
      font-size: 20px;
    }

    .privacy-notice {
      background: rgba(72, 187, 120, 0.1);
      border: 1px solid rgba(72, 187, 120, 0.3);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
    }

    .privacy-notice h4 {
      color: #68d391;
      font-size: 14px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .privacy-notice ul {
      list-style: none;
      padding: 0;
      margin: 0;
      font-size: 12px;
      color: #a0d8b0;
    }

    .privacy-notice ul li {
      padding: 4px 0;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .privacy-notice ul li::before {
      content: "\2713";
      color: #68d391;
      font-weight: bold;
    }

    .legal-links {
      text-align: center;
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 20px;
    }

    .legal-links a {
      color: var(--primary-light);
      text-decoration: none;
    }

    .legal-links a:hover {
      text-decoration: underline;
    }

    .language-switcher {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
    }

    .lang-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }

    .lang-btn:hover, .lang-btn.active {
      background: rgba(255, 255, 255, 0.2);
    }

    .hidden {
      display: none !important;
    }

    /* Confirmation screen */
    .confirmation-screen {
      text-align: center;
    }

    .confirmation-screen .success-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .confirmation-screen h2 {
      color: #68d391;
      margin-bottom: 15px;
    }

    .confirmation-screen p {
      color: var(--text-muted);
      margin-bottom: 25px;
    }

    /* Denied screen */
    .denied-screen {
      text-align: center;
    }

    .denied-screen .denied-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .denied-screen h2 {
      color: #ff6b6b;
      margin-bottom: 15px;
    }

    .denied-screen p {
      color: var(--text-muted);
      margin-bottom: 25px;
    }

    @media (max-width: 480px) {
      .verification-container {
        padding: 25px;
      }

      .logo h1 {
        font-size: 2rem;
      }

      .verify-btn {
        padding: 15px 20px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="language-switcher">
    <button class="lang-btn active" onclick="setLanguage('en')">EN</button>
    <button class="lang-btn" onclick="setLanguage('es')">ES</button>
  </div>

  <div class="verification-container">
    <!-- Main verification screen -->
    <div id="mainScreen">
      <div class="logo">
        <h1>PNPtv!</h1>
        <p class="tagline" data-i18n="tagline">Digital Community</p>
      </div>

      <div class="warning-box">
        <div class="icon">18+</div>
        <h2 data-i18n="warning_title">Adult Content Warning</h2>
        <p data-i18n="warning_text">This website contains age-restricted material including nudity and explicit content. By entering, you confirm that you are at least 18 years old and that viewing this content is legal in your jurisdiction.</p>
      </div>

      <div class="age-question">
        <h3 data-i18n="question">Are you 18 years or older?</h3>
        <p data-i18n="question_sub">You must verify your age to continue</p>
      </div>

      <div class="verification-options">
        <button class="verify-btn primary" onclick="verifyAge('camera')">
          <span class="icon">ðŸ“·</span>
          <span data-i18n="btn_camera">Verify with Camera (Recommended)</span>
        </button>

        <button class="verify-btn secondary" onclick="verifyAge('manual')">
          <span class="icon">âœ“</span>
          <span data-i18n="btn_manual">I confirm I am 18+</span>
        </button>

        <button class="verify-btn exit" onclick="exitSite()">
          <span class="icon">âœ•</span>
          <span data-i18n="btn_exit">I am under 18 - Exit</span>
        </button>
      </div>

      <div class="privacy-notice">
        <h4><span>ðŸ”’</span> <span data-i18n="privacy_title">Your Privacy is Protected</span></h4>
        <ul>
          <li data-i18n="privacy_1">Photos are analyzed instantly and deleted immediately</li>
          <li data-i18n="privacy_2">We never store facial images on our servers</li>
          <li data-i18n="privacy_3">Only verification status is saved, not biometric data</li>
          <li data-i18n="privacy_4">You can delete your account anytime</li>
        </ul>
      </div>

      <div class="legal-links">
        <span data-i18n="legal_agree">By continuing, you agree to our</span>
        <a href="/terms" data-i18n="terms_link">Terms of Service</a> &amp;
        <a href="/privacy" data-i18n="privacy_link">Privacy Policy</a>
      </div>
    </div>

    <!-- Confirmation screen -->
    <div id="confirmationScreen" class="confirmation-screen hidden">
      <div class="success-icon">âœ…</div>
      <h2 data-i18n="confirm_title">Age Verified</h2>
      <p data-i18n="confirm_text">Thank you for confirming your age. You can now access PNPtv content.</p>
      <button class="verify-btn primary" onclick="continueToSite()">
        <span data-i18n="btn_continue">Continue to PNPtv</span>
      </button>
    </div>

    <!-- Denied screen -->
    <div id="deniedScreen" class="denied-screen hidden">
      <div class="denied-icon">ðŸš«</div>
      <h2 data-i18n="denied_title">Access Denied</h2>
      <p data-i18n="denied_text">You must be at least 18 years old to access this content. Please come back when you are of legal age.</p>
      <button class="verify-btn exit" onclick="exitSite()">
        <span data-i18n="btn_leave">Leave Site</span>
      </button>
    </div>
  </div>

  <script>
    // Translations
    const translations = {
      en: {
        tagline: 'Digital Community',
        warning_title: 'Adult Content Warning',
        warning_text: 'This website contains age-restricted material including nudity and explicit content. By entering, you confirm that you are at least 18 years old and that viewing this content is legal in your jurisdiction.',
        question: 'Are you 18 years or older?',
        question_sub: 'You must verify your age to continue',
        btn_camera: 'Verify with Camera (Recommended)',
        btn_manual: 'I confirm I am 18+',
        btn_exit: 'I am under 18 - Exit',
        privacy_title: 'Your Privacy is Protected',
        privacy_1: 'Photos are analyzed instantly and deleted immediately',
        privacy_2: 'We never store facial images on our servers',
        privacy_3: 'Only verification status is saved, not biometric data',
        privacy_4: 'You can delete your account anytime',
        legal_agree: 'By continuing, you agree to our',
        terms_link: 'Terms of Service',
        privacy_link: 'Privacy Policy',
        confirm_title: 'Age Verified',
        confirm_text: 'Thank you for confirming your age. You can now access PNPtv content.',
        btn_continue: 'Continue to PNPtv',
        denied_title: 'Access Denied',
        denied_text: 'You must be at least 18 years old to access this content. Please come back when you are of legal age.',
        btn_leave: 'Leave Site'
      },
      es: {
        tagline: 'Comunidad Digital',
        warning_title: 'Advertencia de Contenido Adulto',
        warning_text: 'Este sitio web contiene material restringido por edad, incluyendo desnudez y contenido explÃ­cito. Al entrar, confirmas que tienes al menos 18 aÃ±os y que ver este contenido es legal en tu jurisdicciÃ³n.',
        question: 'Â¿Tienes 18 aÃ±os o mÃ¡s?',
        question_sub: 'Debes verificar tu edad para continuar',
        btn_camera: 'Verificar con CÃ¡mara (Recomendado)',
        btn_manual: 'Confirmo que tengo 18+',
        btn_exit: 'Soy menor de 18 - Salir',
        privacy_title: 'Tu Privacidad estÃ¡ Protegida',
        privacy_1: 'Las fotos se analizan al instante y se eliminan inmediatamente',
        privacy_2: 'Nunca almacenamos imÃ¡genes faciales en nuestros servidores',
        privacy_3: 'Solo se guarda el estado de verificaciÃ³n, no datos biomÃ©tricos',
        privacy_4: 'Puedes eliminar tu cuenta en cualquier momento',
        legal_agree: 'Al continuar, aceptas nuestros',
        terms_link: 'TÃ©rminos de Servicio',
        privacy_link: 'PolÃ­tica de Privacidad',
        confirm_title: 'Edad Verificada',
        confirm_text: 'Gracias por confirmar tu edad. Ahora puedes acceder al contenido de PNPtv.',
        btn_continue: 'Continuar a PNPtv',
        denied_title: 'Acceso Denegado',
        denied_text: 'Debes tener al menos 18 aÃ±os para acceder a este contenido. Por favor regresa cuando tengas la edad legal.',
        btn_leave: 'Salir del Sitio'
      }
    };

    let currentLang = 'en';

    // Get URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get('user_id');
    const token = urlParams.get('token');
    const langParam = urlParams.get('lang');
    const redirect = urlParams.get('redirect') || '/';

    // Set initial language from URL param
    if (langParam && translations[langParam]) {
      currentLang = langParam;
      updateLanguage();
    }

    function setLanguage(lang) {
      currentLang = lang;
      updateLanguage();

      // Update active button
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
    }

    function updateLanguage() {
      const t = translations[currentLang];
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) {
          el.textContent = t[key];
        }
      });
    }

    function verifyAge(method) {
      if (method === 'camera') {
        // Redirect to camera verification page
        const cameraUrl = `/age-verification-camera.html?user_id=${userId || ''}&token=${token || ''}&lang=${currentLang}`;
        window.location.href = cameraUrl;
      } else if (method === 'manual') {
        // Show confirmation screen
        document.getElementById('mainScreen').classList.add('hidden');
        document.getElementById('confirmationScreen').classList.remove('hidden');

        // Store age verification in localStorage
        localStorage.setItem('ageVerified', 'true');
        localStorage.setItem('ageVerifiedMethod', 'manual');
        localStorage.setItem('ageVerifiedDate', new Date().toISOString());

        // If we have user ID and token, send to backend
        if (userId) {
          fetch('/api/verify-age-manual', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              user_id: userId,
              method: 'manual',
              lang: currentLang
            })
          }).catch(err => console.log('Manual verification logged'));
        }
      }
    }

    function exitSite() {
      // Show denied screen briefly then redirect
      document.getElementById('mainScreen').classList.add('hidden');
      document.getElementById('confirmationScreen').classList.add('hidden');
      document.getElementById('deniedScreen').classList.remove('hidden');

      // Clear any verification
      localStorage.removeItem('ageVerified');

      // Redirect to safe site after 2 seconds
      setTimeout(() => {
        window.location.href = 'https://www.google.com';
      }, 2000);
    }

    function continueToSite() {
      // Redirect to the main site or specified redirect URL
      if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
        Telegram.WebApp.sendData('age_verified:manual');
      } else {
        window.location.href = redirect;
      }
    }

    // Check if already verified
    window.addEventListener('DOMContentLoaded', () => {
      const isVerified = localStorage.getItem('ageVerified');
      if (isVerified === 'true') {
        // Show continue button instead of full verification
        document.getElementById('mainScreen').classList.add('hidden');
        document.getElementById('confirmationScreen').classList.remove('hidden');
      }

      // Initialize Telegram WebApp if available
      if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
      }
    });
  </script>
</body>
</html>
